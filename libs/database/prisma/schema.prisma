// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../../../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Modelo de usuário com informações básicas
model User {
  id            String         @id @default(uuid())
  email         String         @unique
  name          String?
  passwordHash  String
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  subscription  Subscription?
  planId        String?
  plan          Plan?          @relation(fields: [planId], references: [id])

  @@map("users")
}

// Modelo para planos de assinatura
model Plan {
  id        String    @id @default(uuid())
  name      PlanType
  price     Decimal   @db.Decimal(10, 2)
  features  Json?
  isActive  Boolean   @default(true)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  users     User[]

  @@map("plans")
}

// Modelo para assinaturas de usuários
model Subscription {
  id           String           @id @default(uuid())
  userId       String           @unique
  user         User             @relation(fields: [userId], references: [id])
  status       SubscriptionStatus
  startDate    DateTime         @default(now())
  endDate      DateTime?
  externalId   String?          @unique
  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt

  @@map("subscriptions")
}

// Enums para tipos de dados específicos
enum PlanType {
  FREE
  BASIC
  ADVANCED
  PREMIUM
}

enum SubscriptionStatus {
  ACTIVE
  CANCELED
  EXPIRED
  INACTIVE
}
